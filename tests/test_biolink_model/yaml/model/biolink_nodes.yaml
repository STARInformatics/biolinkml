id: http://w3id.org/biolink/biolink-model/relations
name: biolink model relation definitions
description: Relation ontology for use in biolink model
license: https://creativecommons.org/publicdomain/zero/1.0/

prefixes:
  biolink: http://w3id.org/biolink/model/

default_prefix: biolink
# Organized by domain with the exception of inverses, which appear together


imports:
  - includes/types


attributes:
  chemical formula value:
    range: string

  biological sequence:
    range: string

  molecular consequence:
    range: string

  zygosity:
    mappings:
      - "GENO:0000133"

  biological sex:
    subclass_of: "PATO:0000047"

  phenotypic sex:
    description: >-
      An attribute corresponding to the phenotypic sex of the individual, based upon the reproductive organs present.
    subclass_of: "PATO:0001894"
    is_a: biological sex

  genotypic sex:
    description: >-
      An attribute corresponding to the genotypic sex of the individual, based upon genotypic composition of sex chromosomes.
    subclass_of: "PATO:0020000"
    is_a: biological sex

  severity value:
    description: >-
      describes the severity of a phenotypic feature or disease

  frequency value:
    description: >-
      describes the frequency of occurrence of an event or condition

  clinical modifier:
    description: >-
      Used to characterize and specify the phenotypic abnormalities defined in the Phenotypic abnormality subontology,
      with respect to severity, laterality, age of onset, and other aspects
    subclass_of: "HP:0012823"

  onset:
    description: >-
      The age group in which manifestations appear
    mappings:
      - "HP:0003674"

  relationship quantifier:
    abstract: true
    mixin: true

  senstivity quantifier:
    is_a: relationship quantifier
    mixin: true

  specificity quantifier:
    is_a: relationship quantifier
    mixin: true

  pathognomonicity quantifier:
    is_a: specificity quantifier
    description: >-
      A relationship quantifier between a variant or symptom and a disease, which is
      high when the presence of the feature implies the existence of the disease
    mixin: true

  frequency quantifier:
    is_a: relationship quantifier
    mixin: true
    properties:
      - has count
      - has total
      - has quotient
      - has percentage


node_slots:

  # ------------------
  # Geographic location slots
  # ------------------
  timepoint:
    domain: geographic location at time
    range: datetime
    description: a point in time

  latitude:
    domain: geographic location
    range: float
    description: latitude
    iri: wgs:lat

  longitude:
    domain: geographic location
    range: float
    description: longitude
    iri: wgs:long

  in taxon:
    domain: thing with taxon
    range: organism taxon
    description: connects a thing to a class representing a taxon
    in_subset:
      -
    mappings:
      - RO:0002162
      - WD:P703

  has chemical formula:
    domain: tbd
    range: chemical formula value
    description: >-
      description of chemical compound based on element symbols
    mappings:
      - WD:P274
  aggregate statistic:
    abstract: true

  has count:
    description: >-
      number of things with a particular property
    is_a: aggregate statistic
    domain: frequency_quantifier
    range: integer

  has total:
    description: total number of things in a particular reference set
    is_a: aggregate statistic
    domain: frequency_quantifier
    range: integer

  has quotient:
    is_a: aggregate statistic
    domain: frequency_quantifier
    range: double

  has percentage:
    description: equivalent to has quotient multiplied by 100
    is_a: aggregate statistic
    domain: frequency_quantifier
    range: double

  systematic synonym:
    range: label type
    description: more commonly used for gene symbols in yeast

  has biological sequence:
    description: connects a genomic feature to its sequence
    range: biological sequence

  has molecular consequence:
    description: connects a sequence variant to a class describing the molecular
      consequence. E.g.  SO:0001583
    range: molecular consequence

  has gene:
    description: connects and entity to a single gene
    range: gene

  allele has gene:
    is_a: has gene
    multivalued: true
    description: Each allele can be associated with any number of genes

  has zygosity:
    domain: single locus feature complement
    range: zygosity

  phase:
    notes:
      - TODO

  genome build:
    notes:
      - TODO


  interbase coordinate:
    notes:
      - TODO

  start interbase coordinate:
    is_a: interbase coordinate

  end interbase coordinate:
    is_a: interbase coordinate

  drug:
    range: chemical substance
    required: true
    multivalued: true

  has exposure parts:
    multivalued: true
    range: drug exposure
    required: true


# ===============
#  Nodes
# ===============
nodes:

  # -------------------------------------
  # Biological Entity
  # -------------------------------------
  biological entity:
    abstract: true
    mappings:
      - WD:Q28845870

  # biological entity <-- biological process or activity
  biological process or activity:
    is_a: biological entity
    description: Either an individual molecular activity, or a collection of causally connected molecular activities
    union_of:
      - molecular activity
      - biological process
    id_prefixes:
      - GO
      - Reactome

  # biological entity <-- biological process or activity <-- biological process
  biological process:
    is_a: biological process or activity
    mixins:
      - occurrent
    description: One or more causally connected executions of molecular functions
    mappings:
      - GO:0008150
      - SIO:000006
      - WD:Q2996394
    id_prefixes:
      - GO
      - Reactome

  # biological entity <-- biological process or activity <-- biological process <-- pathway
  pathway:
    is_a: biological process
    mappings:
      - GO:0007165
      - SIO:010526
      - PW:0000001
      - WD:Q4915012
    id_prefixes:
      - GO
      - Reactome

  # biological entity <-- biological process or activity <-- biological process <-- physiological process
  physiological process:
    aliases: ['physiology']
    is_a: biological process
    mappings:
      - UMLSSG:PHYS

  # biological entity <-- biological process or activity <-- molecular activity
  molecular activity:
    is_a: biological process or activity
    aliases: ['molecular function', 'molecular event', 'reaction']
    mixins:
      - occurrent
    description: An execution of a molecular function carried out by a gene product or macromolecular complex.
    mappings:
      - GO:0003674
    id_prefixes:
      - GO
      - Reactome

   # biological entity <-- disease or phenotypic feature
  disease or phenotypic feature:
    aliases: ['phenome']
    is_a: biological entity
    description: >-
      Either one of a disease or an individual phenotypic feature. Some knowledge resources such as Monarch treat these as distinct, others such as MESH conflate.
    mixins:
      - thing with taxon
    union_of:
      - disease
      - phenotypic feature

   # biological entity <-- disease or phenotypic feature <-- disease
  disease:
    aliases: ['condition', 'disorder', 'medical condition']
    is_a: disease or phenotypic feature
    mappings:
      - MONDO:0000001
      - WD:Q12136
      - SIO:010299
      - UMLSSG:DISO

  # biological entity <-- disease or phenotypic feature <-- phenotypic feature
  phenotypic feature:
    aliases: ['sign', 'symptom', 'phenotype', 'trait', 'endophenotype']
    is_a: disease or phenotypic feature
    mappings:
      - UPHENO:0001001
      - SIO:010056
      - WD:Q169872

  # biological entity <-- environment
  environment:
    aliases: ['environment', 'exposure', 'experimental condition']
    is_a: biological entity
    description: >-
      A feature of the environment of an organism that influences one or more phenotypic features
      of that organism, potentially mediated by genes
    mappings:
      - SIO:000955

  # biological entity <-- environment <-- drug exposure
  drug exposure:
    aliases: ['drug intake', 'drug dose']
    is_a: environment
    description: >-
      A drug exposure is an intake of a particular chemical substance
    slots:
      - has input
      - drug
    mappings:
      - "ECTO:0000509"
      - SIO:001005

  # biological entity <-- environment <-- treatment
  treatment:
    aliases: ['medical action']
    is_a: environment
    description: >-
      A treatment is targeted at a disease or phenotype and may involve multiple drug 'exposures'
    slots:
      - has exposure parts
    mappings:
      - "OGMS:0000090"
      - SIO:001398

  # biological entity <-- molecular entity
  molecular entity:
    is_a: biological entity
    mixins:
      - thing with taxon
    aliases: ['bioentity']
    description: A gene, gene product, small molecule or macromolecule (including protein complex)
    comments:
       - Check SIO mapping - also mapped to chemical substance.
    mappings:
      - SIO:010004
      - WD:Q43460564

  # biological entity <-- molecular entity <-- chemical substance
  chemical substance:
    is_a: molecular entity
    description: >-
      May be a chemical entity or a formulation with a chemical entity as active ingredient, or a complex
      material with multiple chemical entities as part
    subclass_of: "CHEBI:24431"
    mappings:
      - "SIO:010004"
      - "UMLSSG:CHEM"
      - "WD:Q79529"
    id_prefixes:
      - CHEBI
      - CHEMBL.COMPOUND

  # biological entity <-- molecular entity <-- chemical substance <-- drug
  drug:
    is_a: chemical substance
    description: >-
      A substance intended for use in the diagnosis, cure, mitigation, treatment, or prevention of disease
    comments:
      - The CHEBI ID represents a role rather than a substance
    mappings:
      - WD:Q12140
      - CHEBI:23888

  # biological entity <-- molecular entity <-- chemical substance <-- metabolite
  metabolite:
    is_a: chemical substance
    description: >-
      Any intermediate or product resulting from metabolism. Includes primary and secondary metabolites.
    comments:
      - The CHEBI ID represents a role rather than a substance
    mappings:
      - CHEBI:25212
      -
  # biological entity <-- molecular entity <-- genomic entity
  genomic entity:
    is_a: molecular entity
    aliases: ['sequence feature']
    description: >-
      an entity that can either be directly located on a genome (gene, transcript, exon, regulatory region) or is encoded in a genome (protein)
#    slots:
#      - has biological sequence
    mappings:
      - "SO:0000110"
      - "UMLSSG:GENE"

  # biological entity <-- molecular entity <-- genomic entity <-- genome
  genome:
    is_a: genomic entity
    description: >-
      A genome is the sum of genetic material within a cell or virion.
    mappings:
      - SO:0001026
      - SIO:000984
      - WD:Q7020
      -
  # biological entity <-- molecular entity <-- genomic entity <-- transcript
  transcript:
    is_a: genomic entity
    description: >-
      An RNA synthesized on a DNA or RNA template by an RNA polymerase
    mappings:
      - SO:0000673
      - SIO:010450
      -
  # biological entity <-- molecular entity <-- genomic entity <-- exon
  exon:
    is_a: genomic entity
    description: >-
      A region of the transcript sequence within a gene which is not removed from the primary RNA transcript by RNA splicing
    mappings:
      - SO:0000147
      - SIO:010445
      - WD:Q373027

  # biological entity <-- molecular entity <-- genomic entity <-- coding sequence
  coding sequence:
    is_a: genomic entity
    mappings:
      - SO:0000316
      - SIO:001390

  # biological entity <-- molecular entity <-- genomic entity <-- macromolecular machine
  macromolecular machine:
    is_a: genomic entity
    union_of:
      - gene
      - gene product
      - macromolecular complex
    description: >-
      A union of gene, gene product, and macromolecular complex.
      These are the basic units of function in a cell. They either carry out individual
      biological activities, or they encode molecules which do this.
#    slot_usage:
#      name:
#        range: symbol type
#        description: >-
#          genes are typically designated by a short symbol and a full name. We map the symbol to the default display name
#          and use an additional slot for full name

  # biological entity <-- molecular entity <-- genomic entity <-- macromolecular machine <-- gene or gene product
  gene or gene product:
    is_a: macromolecular machine
    union_of:
      - gene
      - gene product
    description: >-
      a union of genes or gene products.
      Frequently an identifier for one will be used as proxy for another
    id_prefixes:
      - CHEMBL.TARGET

  # biological entity <-- molecular entity <-- genomic entity <-- macromolecular machine <-- gene or gene product <-- gene
  gene:
    is_a: gene or gene product
    aliases: ['locus']
    mappings:
      - "SO:0000704"
      - "SIO:010035"
      - "WD:Q7187"
      - "UMLSSG:GENE"
    id_prefixes:
      - NCBIGene
      - ENSEMBL
      - HGNC
      - MGI
      - ZFIN
      - dictyBase
      - WB
      - SGD
      - PomBase

  # biological entity <-- molecular entity <-- genomic entity <-- macromolecular machine <-- gene or gene product <-- gene product
  gene product:
    is_a: gene or gene product
    description: >-
      The functional molecular product of a single gene. Gene products are either proteins or functional RNA molecules
    union_of:
      - protein
      - RNA product
    mappings:
      - WD:Q424689

  # biological entity <-- molecular entity <-- genomic entity <-- macromolecular machine <-- gene or gene product <-- gene product <-- protein
  protein:
    is_a: gene product
    aliases: ['polypeptide']
    description: >-
      A gene product that is composed of a chain of amino acid sequences and is produced by ribosome-mediated translation of mRNA
    mappings:
      - "PR:000000001"
      - "SIO:010043"
      - "WD:Q8054"
    id_prefixes:
      - UniProtKB
      - PR
      - ENSEMBL

  # biological entity <-- molecular entity <-- genomic entity <-- macromolecular machine <-- gene or gene product <-- gene product <-- protein <-- protein isoform
  protein isoform:
    aliases: ['proteoform']
    is_a: protein
    description: >-
      Represents a protein that is a specific isoform of the canonical or reference protein. See https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4114032/
    mixins:
      - gene product isoform
    id_prefixes:
      - UniProtKB
      - PR
      - ENSEMBL

  # biological entity <-- molecular entity <-- genomic entity <-- macromolecular machine <-- gene or gene product <-- gene product <-- gene product isoform
  gene product isoform:
    is_a: gene product
    description: >-
      This is an abstract class that can be mixed in with different kinds of gene products to indicate that the gene product is intended to
      represent a specific isoform rather than a canonical or reference or generic product. The designation of canonical or reference may be arbitrary,
      or it may represent the superclass of all isoforms.
    abstract: true
    # entity: true

  # biological entity <-- molecular entity <-- genomic entity <-- macromolecular machine <-- gene or gene product <-- gene product <-- RNA product
  RNA product:
    is_a: gene product
    mappings:
      - "CHEBI:33697"
      - SIO:010450
      - WD:Q11053
    id_prefixes:
      - RNAcentral

  # biological entity <-- molecular entity <-- genomic entity <-- macromolecular machine <-- gene or gene product <-- gene product <-- RNA product <-- RNA product isoform
  RNA product isoform:
    is_a: RNA product
    description: >-
      Represents a protein that is a specific isoform of the canonical or reference RNA
    mixins:
      - gene product isoform
    id_prefixes:
      - RNAcentral

  # biological entity <-- molecular entity <-- genomic entity <-- macromolecular machine <-- gene or gene product <-- gene product <-- RNA product <-- noncoding RNA product
  noncoding RNA product:
    is_a: RNA product
    id_prefixes:
      - RNAcentral
      - NCBIGene
      - ENSEMBL
    subclass_of: SO:0000655
    mappings:
      - SIO:001235

  # biological entity <-- molecular entity <-- genomic entity <-- macromolecular machine <-- gene or gene product <-- gene product <-- RNA product <-- noncoding RNA product <-- microRNA
  microRNA:
    is_a: noncoding RNA product
    subclass_of: SO:0000276
    mappings:
      - SIO:001397
      - WD:Q310899
    id_prefixes:
      - MIR

  # biological entity <-- molecular entity <-- genomic entity <-- macromolecular machine <-- macromolecular complex
  macromolecular complex:
    is_a: macromolecular machine
    subclass_of: "GO:0032991"
    mappings:
      - "SIO:010046"
      - WD:Q22325163
    id_prefixes:
      - IntAct
      - GO
      - PR
      - Reactome

  # biological entity <-- molecular entity <-- genomic entity <-- genotype
  genotype:
    is_a: genomic entity
    description: >-
      An information content entity that describes a genome by specifying the total variation in genomic sequence and/or gene expression, relative to some extablished background
    comments:
      - Consider renaming as genotypic entity
    mappings:
      - "GENO:0000536"
      - SIO:001079

  # biological entity <-- molecular entity <-- genomic entity <-- haplotype
  haplotype:
    is_a: genomic entity
    description: >-
      A set of zero or more Alleles on a single instance of a Sequence[VMC]
#    slots:
#      - completeness
    mappings:
      - GENO:0000871
      - VMC:Haplotype

  # biological entity <-- molecular entity <-- genomic entity <-- sequence variant
  sequence variant:
    aliases: ['allele']
    local_names:
      agr: allele
    is_a: genomic entity
    description: >-
      An allele that varies in its sequence from what is considered the reference allele at that locus.
    comments:
      - This class is for modeling the specific state at a locus. A single dbSNP rs ID could correspond to more
        than one sequence variants (e.g CIViC:1252 and CIViC:1253, two distinct BRCA2 alleles for rs28897743)
    mappings:
      - GENO:0000002
      - WD:Q15304597
      - SIO:010277
      - VMC:Allele
    id_prefixes:
      - ClinVar
      - WD
      - CIViC
    alt_descriptions:
      - description: "An enitity that describes a single affected, endogenous allele.  These can be of any type that matches that definition"
        source: AGR
      - description: "A contiguous change at a Location"
        source: VMC
    slots:
      - allele has gene
      - has biological sequence
#    slot_usage:
#      id:
#        examples:
#          - value: ZFIN:ZDB-ALT-980203-1091
#            description: ti282a allele from ZFIN
#          - value: ClinVarVariant:17681
#            description: NM_007294.3(BRCA1):c.2521C>T (p.Arg841Trp)

  # biological entity <-- molecular entity <-- gene family
  gene family:
    is_a: molecular entity
    mappings:
      - SIO:001380
      - "NCIT:C20130"
      - WD:Q417841
    mixins:
      - gene grouping
    description: >-
      any grouping of multiple genes or gene products related by common descent
    id_prefixes:
      - PANTHER


  # biological entity <-- organismal entity
  organismal entity:
    description: >-
      A named entity that is either a part of an organism, a whole organism, population or slass of organisms,
      excluding molecular entities
    abstract: true
    is_a: biological entity
    mappings:
      - WD:Q7239

  # biological entity <-- organismal entity <-- anatomical entity
  anatomical entity:
    is_a: organismal entity
    mixins:
      - thing with taxon
    subclass_of: UBERON:0001062
    description: A subcellular location, cell type or gross anatomical part
    mappings:
      - "UMLSSG:ANAT"
      - SIO:010046
      - WD:Q4936952

  # biological entity <-- organismal entity <-- anatomical entity <-- cellular component
  cellular component:
    is_a: anatomical entity
    description: >-
      A location in or around a cell
    mappings:
      - "GO:0005575"
      - SIO:001400
      - WD:Q5058355
    id_prefixes:
      - GO

  # biological entity <-- organismal entity <-- anatomical entity <-- cell
  cell:
    is_a: anatomical entity
    mappings:
      - "GO:0005623"
      - "CL:0000000"
      - "SIO:010001"
      - WD:Q7868
    id_prefixes:
      - CL
      - PO

  # biological entity <-- organismal entity <-- anatomical entity <-- gross anatomical structure
  gross anatomical structure:
    aliases: ['tissue', 'organ']
    is_a: anatomical entity
    mappings:
      - UBERON:0010000
      - SIO:010046
      - WD:Q4936952
    id_prefixes:
      - UBERON
      - PO
      - FAO

  # biological entity <-- organismal entity <-- individual organism
  individual organism:
    mixins:
      - thing with taxon
    is_a: organismal entity
    subclass_of: "NCBITaxon:1"
    mappings:
      - SIO:010000
      - UMLSSG:LIVB
      - WD:Q795052

  # biological entity <-- organismal entity <-- individual organism <-- case
  case:
    aliases: ['patient', 'proband']
    is_a: individual organism
    description: An individual organism that has a patient role in some clinical context.

  # biological entity <-- organismal entity <-- population of individual organisms
  population of individual organisms:
    is_a: organismal entity
    local_names:
      ga4gh: population
    mixins:
      - thing with taxon
    subclass_of: PCO:0000001
    mappings:
      - SIO:001061
    id_prefixes:
      - HANCESTRO

  # biological entity <-- organismal entity <-- biosample
  biosample:
    is_a: organismal entity
    aliases: ['biospecimen', 'sample']
    mixins:
      - thing with taxon
    mappings:
      - SIO:001050

  # biological entity <-- organismal entity <-- biosample <-- cell line
  cell line:
    is_a: biosample
    mappings:
      - "CLO:0000031"
    id_prefixes:
      - CLO

  # biological entity <-- organismal entity <-- life stage
  life stage:
    is_a: organismal entity
    mixins:
      - thing with taxon
    subclass_of: UBERON:0000105
    description: A stage of development or growth of an organism, including post-natal adult stages

  # -------------------------------------
  # Clinical Entity
  # -------------------------------------
  clinical entity:
    is_a: named thing
    description: >-
      Any entity or process that exists in the clinical domain and outside the biological realm.
      Diseases are placed under biological entities

  # clinical entity <-- clinical trial
  clinical trial:
    is_a: clinical entity

  # clinical entity <-- clinical intervention
  clinical intervention:
    is_a: clinical entity

  # -------------------------------------
  # Device
  # -------------------------------------
  device:
    is_a: named thing
    description: >-
      A thing made or adapted for a particular purpose, especially a piece of mechanical or electronic equipment
    mappings:
      - "UMLSSG:DEVI"


  # -------------------------------------
  # Occurrent
  # -------------------------------------
  occurrent:
    is_a: named thing
    description: A processual entity
    mixin: true
    mappings:
      - "BFO:0000003"

  # occurrent <-- activity and behavior
  activity and behavior:
    is_a: occurrent
    description: Activity or behavior of any independent integral living, organization or mechanical actor in the world
    mappings:
      - "UMLSSG:ACTI"

  # occurrent <-- procedure
  procedure:
    is_a: occurrent
    description: A series of actions conducted in a certain order or manner
    mappings:
      - "UMLSSG:PROC"

  # occurrent <-- phenomenon
  phenomenon:
    is_a: occurrent
    description: >-
      a fact or situation that is observed to exist or happen, especially one whose cause or explanation is in question
    mappings:
      - "UMLSSG:PHEN"

  organism taxon:
    values_from:
      - NCBITaxon
    mappings:
      - WD:Q16521

  # -------------------------------------
  # Planetary nodes
  # -------------------------------------
  planetary entity:
    is_a: named thing
    description: >-
      Any entity or process that exists at the level of the whole planet

  # planetary entity <-- environmental process
  environmental process:
    is_a: planetary entity
    mixins:
      - occurrent
    subclass_of: ENVO:02500000

  # planetary entity <-- environmental feature
  environmental feature:
    is_a: planetary entity
    subclass_of: ENVO:00002297

  # planetary entity <-- geographic location
  geographic location:
    is_a: planetary entity
    description: a location that can be described in lat/long coordinates
    slots:
      - latitude
      - longitude
    mappings:
      - "UMLSSG:GEOG"

  # planetary entity <-- geographic location <-- geographic location at time
  geographic location at time:
    is_a: geographic location
    description: >-
      a location that can be described in lat/long coordinates, for a particular time
    slots:
      - timepoint

  # -------------------------------------
  # Node mixins
  # -------------------------------------
  thing with taxon:
    abstract: true
    mixin: true
    description: >-
      A mixin that can be used on any entity with a taxon
    slots:
      - in taxon


